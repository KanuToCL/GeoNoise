<!doctype html>
<html lang="en" data-theme="default" data-feature-profile-dropdown="false" data-feature-probe-engine-controls="true">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GeoNoise - Environmental Noise Modeling & Acoustic Propagation Software</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="GeoNoise is a free, browser-based environmental noise modeling tool for acoustic consultants and engineers. Features ISO 9613-2 propagation, barrier diffraction, ground effects, and multi-path ray tracing with coherent phasor summation." />
    <meta name="keywords" content="noise modeling software, environmental noise, acoustic propagation, ISO 9613-2, sound propagation, noise mapping, barrier diffraction, ground effect, noise assessment, acoustic software, sound level prediction, noise contour map, environmental acoustics, outdoor sound propagation, noise consultant tools, free noise software, web-based acoustics, Maekawa diffraction, Delany-Bazley, atmospheric absorption, noise heatmap" />
    <meta name="author" content="GeoNoise" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <link rel="canonical" href="https://geonoise.app/" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://geonoise.app/" />
    <meta property="og:title" content="GeoNoise - Environmental Noise Modeling Software" />
    <meta property="og:description" content="Free browser-based noise modeling with ISO 9613-2 propagation, barrier diffraction, ground effects, and coherent multi-path ray tracing. No installation required." />
    <meta property="og:image" content="https://geonoise.app/og-image.png" />
    <meta property="og:site_name" content="GeoNoise" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://geonoise.app/" />
    <meta name="twitter:title" content="GeoNoise - Environmental Noise Modeling Software" />
    <meta name="twitter:description" content="Free browser-based noise modeling with ISO 9613-2 propagation, barrier diffraction, ground effects, and coherent multi-path ray tracing." />
    <meta name="twitter:image" content="https://geonoise.app/twitter-card.png" />

    <!-- Schema.org Structured Data for Software Application -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "GeoNoise",
      "applicationCategory": "EngineeringApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "Environmental noise modeling and acoustic propagation software for calculating outdoor sound levels. Implements ISO 9613-2 for noise mapping, barrier diffraction (Maekawa), ground effects (Delany-Bazley), and multi-path ray tracing with coherent phasor summation.",
      "featureList": [
        "ISO 9613-2 sound propagation",
        "Barrier diffraction (Maekawa formula)",
        "Ground effect modeling (Delany-Bazley, Miki)",
        "Atmospheric absorption (ISO 9613-1)",
        "Multi-path ray tracing",
        "Coherent phasor summation",
        "Noise contour mapping",
        "Building reflection and occlusion",
        "9-band octave spectrum analysis (63 Hz - 16 kHz)",
        "A/C/Z frequency weighting",
        "Real-time noise map updates",
        "CSV/JSON export"
      ],
      "softwareHelp": {
        "@type": "CreativeWork",
        "name": "GeoNoise Documentation",
        "url": "https://geonoise.app/docs"
      }
    }
    </script>

    <!-- Schema.org FAQ for common acoustic questions -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is ISO 9613-2?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "ISO 9613-2 is the international standard for calculating outdoor sound propagation. It accounts for geometric divergence, atmospheric absorption, ground effects, barrier diffraction, and other attenuation factors. GeoNoise implements the full ISO 9613-2 model for noise mapping."
          }
        },
        {
          "@type": "Question",
          "name": "How does barrier diffraction work?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Barrier diffraction uses the Maekawa formula: A_bar = 10¬∑log‚ÇÅ‚ÇÄ(3 + 20N) where N is the Fresnel number. Sound bends over and around barriers, with higher frequencies attenuated more than lower frequencies. GeoNoise calculates both over-top and side diffraction paths."
          }
        },
        {
          "@type": "Question",
          "name": "What is the ground dip phenomenon?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The ground dip is a frequency-dependent reduction in sound level caused by destructive interference between direct and ground-reflected sound waves. It typically occurs around 200-500 Hz depending on geometry. GeoNoise models this using coherent two-ray phasor summation."
          }
        },
        {
          "@type": "Question",
          "name": "What is the Delany-Bazley model?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The Delany-Bazley model calculates ground surface impedance from flow resistivity: Z = 1 + 9.08(f/œÉ)^(-0.75) - j¬∑11.9(f/œÉ)^(-0.73). It's used to determine how much sound is reflected vs absorbed by the ground. GeoNoise supports both Delany-Bazley and the Miki extension."
          }
        }
      ]
    }
    </script>
<link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
    <!-- KaTeX for LaTeX equation rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" crossorigin="anonymous"
      onload="renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false}
        ],
        throwOnError: false
      });"></script>
    <link rel="stylesheet" href="./styles/theme.css" />
    <link rel="stylesheet" href="./style.css" />
    <script type="importmap">
      {
        "imports": {
          "@geonoise/shared": "/packages/shared/dist/index.js",
          "@geonoise/core": "/packages/core/dist/index.js",
          "@geonoise/core/coords": "/packages/core/dist/coords/index.js",
          "@geonoise/geo": "/packages/geo/dist/index.js",
          "@geonoise/engine": "/packages/engine/dist/index.js",
          "@geonoise/engine-backends": "/packages/engine-backends/dist/index.js",
          "@geonoise/engine-webgpu": "/packages/engine-webgpu/dist/index.js",
          "zod": "https://esm.sh/zod@3.22.4"
        }
      }
    </script>
  </head>
  <body>
    <div class="app-shell">
      <!-- Fullscreen map canvas layer. -->
        <div class="canvas-frame">
          <!-- Mapbox map overlay container (hidden by default) -->
          <div id="mapboxContainer" class="mapbox-container" style="display: none; position: absolute; inset: 0; z-index: 0;"></div>

          <!-- Main canvas for noise visualization -->
          <canvas id="mapCanvas" style="position: absolute; inset: 0; z-index: 1;"></canvas>

          <!-- Floating Map Control Panel (hidden by default, shown by JS when ENABLE_MAPBOX is true) -->
          <div id="mapControlPanel" style="
            position: absolute;
            top: 80px;
            right: 16px;
            z-index: 1000;
            background: rgba(40, 44, 52, 0.95);
            border-radius: 12px;
            padding: 12px 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            gap: 10px;
            min-width: 220px;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.1);
          ">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
              <span style="font-size: 13px; font-weight: 600; color: #fff;">üó∫Ô∏è Map Overlay</span>
              <span id="mapStatusBadge" style="
                font-size: 10px;
                padding: 2px 8px;
                border-radius: 10px;
                background: #dc3545;
                color: white;
              ">OFF</span>
            </div>

            <button id="loadMapButton" type="button" style="
              padding: 10px 16px;
              font-size: 13px;
              font-weight: 500;
              border: none;
              border-radius: 8px;
              background: linear-gradient(135deg, #4a90d9, #357abd);
              color: white;
              cursor: pointer;
              transition: all 0.2s;
            ">
              Load Map
            </button>

            <div id="mapControls" style="display: none; flex-direction: column; gap: 10px;">
              <!-- Location Search -->
              <div style="display: flex; flex-direction: column; gap: 6px; position: relative;">
                <label style="font-size: 11px; color: #aaa; font-weight: 500;">Search Location:</label>
                <input id="mapSearchInput" type="text" placeholder="Search address or place..."
                  style="padding: 8px 10px; font-size: 11px; border-radius: 6px; background: rgba(255,255,255,0.1); color: #fff; border: none; outline: none;">
                <div id="mapSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: rgba(40,44,52,0.98); border-radius: 6px; max-height: 200px; overflow-y: auto; z-index: 10; margin-top: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);"></div>
              </div>

              <!-- Coordinate Input -->
              <div style="display: flex; flex-direction: column; gap: 6px;">
                <label style="font-size: 11px; color: #aaa; font-weight: 500;">Coordinates:</label>
                <div style="display: flex; gap: 6px; align-items: center;">
                  <input id="mapLatInput" type="text" placeholder="Lat"
                    style="flex: 1; padding: 8px 6px; font-size: 11px; border-radius: 6px; background: rgba(255,255,255,0.1); color: #fff; border: none; outline: none; text-align: center;">
                  <input id="mapLngInput" type="text" placeholder="Lng"
                    style="flex: 1; padding: 8px 6px; font-size: 11px; border-radius: 6px; background: rgba(255,255,255,0.1); color: #fff; border: none; outline: none; text-align: center;">
                  <button id="mapGoToCoords" type="button" style="padding: 8px 12px; font-size: 11px; border: none; border-radius: 6px; background: rgba(74, 144, 217, 0.5); color: #fff; cursor: pointer;">Go</button>
                </div>
              </div>

              <!-- Style Switcher -->
              <div style="display: flex; flex-direction: column; gap: 6px;">
                <label style="font-size: 11px; color: #aaa; font-weight: 500;">Map Style:</label>
                <div style="display: flex; gap: 6px;">
                  <button id="mapStyleStreets" type="button" style="
                    flex: 1;
                    padding: 8px 10px;
                    font-size: 11px;
                    border: none;
                    border-radius: 6px;
                    background: rgba(255,255,255,0.1);
                    color: #ccc;
                    cursor: pointer;
                  ">Streets</button>
                  <button id="mapStyleSatellite" type="button" style="
                    flex: 1;
                    padding: 8px 10px;
                    font-size: 11px;
                    border: none;
                    border-radius: 6px;
                    background: rgba(255,255,255,0.1);
                    color: #ccc;
                    cursor: pointer;
                  ">Satellite</button>
                  <button id="mapStyleDark" type="button" style="
                    flex: 1;
                    padding: 8px 10px;
                    font-size: 11px;
                    border: none;
                    border-radius: 6px;
                    background: rgba(74, 144, 217, 0.5);
                    color: #fff;
                    cursor: pointer;
                  ">Dark</button>
                </div>
              </div>

              <div style="display: flex; align-items: center; gap: 8px;">
                <label style="font-size: 11px; color: #aaa;">Opacity:</label>
                <input id="mapOpacitySlider" type="range" min="10" max="100" value="80" style="flex: 1; accent-color: #4a90d9;">
                <span id="mapOpacityValue" style="font-size: 11px; color: #aaa; min-width: 32px;">80%</span>
              </div>

              <div style="font-size: 10px; color: #888; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1);">
                <div id="mapScaleInfo">Scale: -- m/px</div>
                <div id="mapCenterInfo">Center: --, --</div>
              </div>

              <!-- Toggle Map Interactivity -->
              <button id="toggleMapInteractiveButton" type="button" style="
                padding: 8px 12px;
                font-size: 12px;
                border: none;
                border-radius: 6px;
                background: rgba(74, 144, 217, 0.3);
                color: #4a90d9;
                cursor: pointer;
              ">üîì Enable Map Panning</button>

              <button id="hideMapButton" type="button" style="
                padding: 8px 12px;
                font-size: 12px;
                border: none;
                border-radius: 6px;
                background: rgba(220, 53, 69, 0.2);
                color: #dc3545;
                cursor: pointer;
                margin-top: 4px;
              ">Hide Map</button>
            </div>
          </div>

          <div class="snap-indicator" id="snapIndicator"></div>
        <!-- Help button and status on left side -->
        <div class="canvas-corner-left" id="canvasCornerLeft">
          <div class="canvas-help" id="canvasHelp">
            <button
              class="ghost ui-button canvas-help-button"
              id="canvasHelpButton"
              type="button"
              aria-expanded="false"
              aria-label="Canvas help"
            >
              ?
            </button>
            <div class="canvas-help-tooltip" id="canvasHelpTooltip" role="tooltip">
              <div class="canvas-help-title">Canvas Controls</div>
              <div class="canvas-help-body">
                <strong>Navigation</strong><br>
                Drag: Pan the map<br>
                Scroll: Zoom in/out<br><br>
                <strong>Selection</strong><br>
                Click: Select item<br>
                ‚åò+Drag: Box select multiple<br>
                Double-click: Quick edit<br><br>
                <strong>Editing</strong><br>
                Drag element: Move (live update)<br>
                Shift+Drag: Duplicate item<br>
                ‚åò+D: Duplicate selected<br>
                Delete/Backspace: Remove selected<br>
                Escape: Deselect / Cancel<br><br>
<strong>Tools</strong><br>
                V: Select &nbsp; S: Source &nbsp; R: Receiver<br>
                B: Barrier &nbsp; H: Building &nbsp; G: Grid<br>
                P: Probe
              </div>
            </div>
          </div>
          <!-- Status info to the right of help button -->
          <div class="canvas-status">
            <div class="scale-bar">
              <div class="scale-line" id="scaleLine"></div>
              <div class="scale-text" id="scaleText">100 m</div>
            </div>
            <!-- Scale Comparison Panel (visible when map is loaded) - DRAGGABLE -->
            <div id="scaleComparisonPanel" style="
              display: none;
              position: fixed;
              bottom: 80px;
              left: 16px;
              padding: 8px 12px;
              background: rgba(0, 0, 0, 0.85);
              border: 2px solid #00ff88;
              border-radius: 6px;
              pointer-events: auto;
              cursor: move;
              user-select: none;
              z-index: 1000;
              box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            ">
              <div id="scaleComparisonDragHandle" style="font-size: 10px; color: #00ff88; font-weight: 600; margin-bottom: 6px; cursor: move; display: flex; align-items: center; gap: 4px;">
                <span style="opacity: 0.5;">‚ãÆ‚ãÆ</span> üìè SCALE COMPARISON
              </div>
              <div style="display: flex; flex-direction: column; gap: 4px;">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <span style="font-size: 10px; color: #aaa; width: 70px;">GeoNoise:</span>
                  <div style="display: flex; align-items: center; gap: 4px;">
                    <div id="geonoiseCompareBar" style="height: 4px; background: #4a90d9; border-radius: 2px; width: 100px;"></div>
                    <span id="geonoiseCompareText" style="font-size: 11px; color: #4a90d9; font-weight: 600;">100 m</span>
                  </div>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <span style="font-size: 10px; color: #aaa; width: 70px;">Mapbox:</span>
                  <div style="display: flex; align-items: center; gap: 4px;">
                    <div id="mapboxCompareBar" style="height: 4px; background: #00ff88; border-radius: 2px; width: 100px;"></div>
                    <span id="mapboxCompareText" style="font-size: 11px; color: #00ff88; font-weight: 600;">100 m</span>
                  </div>
                </div>
              </div>
              <div id="scaleMatchIndicator" style="margin-top: 6px; font-size: 10px; text-align: center; padding: 4px; border-radius: 4px; background: #28a745; color: white;">‚úì SCALES MATCH</div>
            </div>
            <div class="canvas-status-line" aria-live="polite">
              <span class="canvas-status-item">x: <span id="debug-x">0.0</span>m y: <span id="debug-y">0.0</span>m</span>
              <span class="canvas-status-sep">|</span>
              <span class="canvas-status-item">Units: Meters</span>
              <span class="canvas-status-sep">|</span>
              <span class="canvas-status-item">Mode: <span id="debug-mode">Select</span></span>
              <span class="canvas-status-sep">|</span>
              <button
                class="status-refine-button"
                id="refineButton"
                type="button"
                title="Force high-quality refine"
                aria-label="Force high-quality refine"
              >
                <span class="status-refine-icon" aria-hidden="true">‚ü≥</span>
                <span>Refine</span>
              </button>
            </div>
          </div>
        </div>
        <!-- Color bar and settings on right side -->
        <div class="canvas-corner">
          <div class="db-legend" id="dbLegend" role="group" aria-label="Decibel legend">
            <div class="db-legend-bar">
              <div class="db-legend-gradient" id="dbLegendGradient" aria-hidden="true"></div>
              <div class="db-legend-labels" id="dbLegendLabels">
                <span>30 dB</span>
                <span>85 dB</span>
              </div>
            </div>
          </div>
          <!-- Settings gear button next to color bar -->
          <div class="settings-toggle" id="settingsToggle">
            <button
              class="ghost ui-button canvas-help-button"
              id="settingsButton"
              type="button"
              aria-expanded="false"
              aria-controls="settingsPopover"
              aria-label="Settings"
              title="Display and simulation settings"
            >
              ‚öô
            </button>
            <div class="settings-popover settings-popover--corner" id="settingsPopover" aria-hidden="true">
<!-- Category Selection Stack -->
              <div class="settings-categories" id="settingsCategories">
                <div class="settings-header">settings</div>
                <span class="settings-profile-indicator" id="settingsProfileIndicator">physically accurate</span>

                  <div class="settings-category-stack">
                  <button class="settings-category-btn" id="settingsCatPhysics" data-category="physics" type="button">
                    physics
                  </button>
                  <button class="settings-category-btn" id="settingsCatEnviron" data-category="environmental" type="button">
                    environmental
                  </button>
                  <button class="settings-category-btn" id="settingsCatDisplay" data-category="display" type="button">
                    display
                  </button>
                  <button class="settings-category-btn" id="settingsCatLayers" data-category="layers" type="button">
                    layers
                  </button>
                </div>
              </div>
            </div>

            <!-- Slide-out Panel (separate popup to the left of settings) -->
            <div class="settings-slide-popup" id="settingsSlidePopup" aria-hidden="true">
              <!-- Display Panel -->
              <div class="settings-slide-panel" id="settingsPanelDisplay" data-panel="display">
<div class="settings-panel-header">display</div>
                <div class="settings-panel-content">
                  <div class="settings-section">
                    <div class="settings-title">frequency</div>
                    <label class="property-row property-row-stack">
                      <span>Weighting</span>
                      <select class="ui-inset" id="displayWeighting">
                        <option value="A" selected>A-weighting (dBA)</option>
                        <option value="C">C-weighting (dBC)</option>
                        <option value="Z">Z-weighting (dBZ / Linear)</option>
                      </select>
                    </label>
<label class="property-row property-row-stack">
                      <span>Display Band</span>
                      <select class="ui-inset" id="displayBand">
                        <option value="overall" selected>Overall (Sum)</option>
                        <option value="0">63 Hz</option>
                        <option value="1">125 Hz</option>
                        <option value="2">250 Hz</option>
                        <option value="3">500 Hz</option>
                        <option value="4">1000 Hz</option>
                        <option value="5">2000 Hz</option>
                        <option value="6">4000 Hz</option>
                        <option value="7">8000 Hz</option>
                        <option value="8">16000 Hz</option>
                      </select>
                    </label>
                  </div>
                  <div class="settings-section">
                    <div class="settings-title">map rendering</div>
                    <label class="toggle" for="mapRenderStyle">
                      <input type="checkbox" id="mapRenderStyle" />
                      <span>Contour Mode</span>
                    </label>
                    <div class="property-row map-band-step" id="mapBandStepRow">
                      <span>Band Step (dB)</span>
                      <input class="ui-inset" id="mapBandStep" type="number" min="1" max="20" step="1" value="3" />
                    </div>
                    <label class="toggle" for="mapAutoScale">
                      <input type="checkbox" id="mapAutoScale" checked />
                      <span>Auto-scale colors</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- Environmental Panel -->
              <div class="settings-slide-panel" id="settingsPanelEnviron" data-panel="environmental">
<div class="settings-panel-header">environmental</div>
                <div class="settings-panel-content">
                  <div class="settings-section">
                    <div class="settings-title">conditions</div>
                    <label class="property-row property-row-stack">
                      <span>Temperature</span>
                      <div class="input-with-unit">
                        <input type="number" class="ui-inset" id="meteoTemperature" value="20" min="-10" max="40" step="1" />
                        <span class="unit-label">¬∞C</span>
                      </div>
                    </label>
                    <label class="property-row property-row-stack">
                      <span>Relative Humidity</span>
                      <div class="input-with-unit">
                        <input type="number" class="ui-inset" id="meteoHumidity" value="50" min="10" max="100" step="5" />
                        <span class="unit-label">%</span>
                      </div>
                    </label>
                    <label class="property-row property-row-stack">
                      <span>Atmospheric Pressure</span>
                      <div class="input-with-unit">
                        <input type="number" class="ui-inset" id="meteoPressure" value="101.325" min="95" max="108" step="0.1" />
                        <span class="unit-label">kPa</span>
                      </div>
                    </label>
                    <div class="property-row property-row-stack derived-value">
                      <span>Speed of Sound</span>
                      <div class="derived-display" id="derivedSpeedOfSound">343.4 m/s</div>
                    </div>
                  </div>
<div class="settings-section">
                    <div class="settings-title">atmospheric absorption</div>
                    <label class="property-row property-row-stack">
                      <span>Model</span>
                      <select class="ui-inset" id="propagationAbsorption">
                        <option value="iso9613">ISO 9613-1</option>
                        <option value="simple">Simple</option>
                        <option value="none">None (Disabled)</option>
                      </select>
                    </label>
                    <div class="equation-collapsible" data-equation="atmosphericAbsorption">
                      <div class="equation-header" role="button" tabindex="0">
                        <span class="equation-toggle">‚ñ∂</span>
                        <span>equation</span>
                      </div>
                      <div class="equation-content" hidden>
                        <div class="equation-main" id="atmAbsorptionEquation">$A_{atm} = \alpha(f) \cdot d / 1000$</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

<!-- Physics Panel -->
              <div class="settings-slide-panel" id="settingsPanelPhysics" data-panel="physics">
                <div class="settings-panel-header">physics</div>
                <div class="settings-panel-content">

<!-- Calculation Profile Selector -->
                  <div class="settings-section physics-profile-section">
                    <div class="settings-title">calculation profile</div>
                    <label class="property-row property-row-stack">
                      <select class="ui-inset profile-select" id="calculationProfile">
                        <option value="iso9613">ISO 9613-2:1996</option>
                        <option value="accurate" selected>Physically Accurate</option>
                        <option value="custom" disabled>Custom</option>
                      </select>
                    </label>
                  </div>

<!-- SHARED Section -->
                  <div class="settings-section physics-engine-section">
                    <div class="settings-title">shared</div>
                    <label class="property-row property-row-stack">
                      <span>Spreading Loss</span>
                      <select class="ui-inset" id="propagationSpreading">
                        <option value="spherical">Spherical</option>
                        <option value="cylindrical">Cylindrical</option>
                      </select>
                    </label>
<div class="equation-collapsible" data-equation="spreading">
                      <div class="equation-header" role="button" tabindex="0">
                        <span class="equation-toggle">‚ñ∂</span>
                        <span>equation</span>
                      </div>
<div class="equation-content" hidden>
                        <div class="equation-main">$A_{div} = 20\log_{10}(d) + 10\log_{10}(4\pi)$</div>
                      </div>
                    </div>
                    <label class="property-row property-row-stack">
                      <span>Ground Surface</span>
                      <select class="ui-inset" id="propagationGroundType">
                        <option value="hard">Hard (Asphalt, Concrete)</option>
                        <option value="mixed" selected>Mixed</option>
                        <option value="soft">Soft (Grass, Soil)</option>
                      </select>
                    </label>
                  </div>

                  <!-- GRID ENGINE Section -->
                  <div class="settings-section physics-engine-section">
                    <div class="settings-title">grid engine</div>
                    <div class="engine-subtitle">Heatmaps ¬∑ Receivers ¬∑ Measure Grids</div>
                    <label class="toggle" for="propagationGroundReflection">
                      <input type="checkbox" id="propagationGroundReflection" />
                      <span>Ground Effects</span>
                    </label>
                    <label class="property-row property-row-stack">
                      <span>Ground Effect Model</span>
                      <select class="ui-inset" id="propagationGroundModel">
                        <option value="twoRayPhasor">Ground Interference</option>
                        <option value="legacy">ISO 9613-2</option>
                      </select>
                    </label>
<div class="equation-collapsible" data-equation="groundModel">
                      <div class="equation-header" role="button" tabindex="0">
                        <span class="equation-toggle">‚ñ∂</span>
                        <span>equation</span>
                      </div>
                      <div class="equation-content" hidden>
                        <div class="equation-main" id="groundModelEquation">$A_{gr} = -20\log_{10}|1 + \Gamma \cdot (r_1/r_2) \cdot e^{jk(r_2-r_1)}|$</div>
                      </div>
                    </div>
<label class="property-row property-row-stack" id="propagationGroundMixedSigmaModelRow">
                      <span>Mixed Interpolation</span>
                      <select class="ui-inset" id="propagationGroundMixedSigmaModel">
                        <option value="iso9613" selected>ISO 9613-2 (Linear)</option>
                        <option value="logarithmic">Logarithmic</option>
                      </select>
                    </label>
                    <div class="equation-collapsible" data-equation="mixedInterpolation">
                      <div class="equation-header" role="button" tabindex="0">
                        <span class="equation-toggle">‚ñ∂</span>
                        <span>equation</span>
                      </div>
                      <div class="equation-content" hidden>
                        <div class="equation-main" id="mixedInterpEquation">$\sigma_{eff} = \sigma_{soft} / G$</div>
                      </div>
                    </div>
<label class="property-row property-row-stack">
                      <span>Side Diffraction</span>
                      <select class="ui-inset" id="propagationBarrierSideDiffraction">
                        <option value="off">Off (Over-top only)</option>
                        <option value="auto" selected>Auto (&lt; 50m barriers)</option>
                        <option value="on">On (All barriers)</option>
                      </select>
                    </label>
                    <div class="equation-collapsible" data-equation="sideDiffraction">
                      <div class="equation-header" role="button" tabindex="0">
                        <span class="equation-toggle">‚ñ∂</span>
                        <span>equation</span>
                      </div>
                      <div class="equation-content" hidden>
                        <div class="equation-main" id="sideDiffractionEquation">$\delta = \min(\delta_{top}, \delta_{left}, \delta_{right})$</div>
                      </div>
                    </div>
                  </div>

<!-- PROBE ENGINE Section (Feature Flagged - not wired to engine yet) -->
                  <div class="settings-section physics-engine-section feature-probe-engine-controls">
                    <div class="settings-title">probe engine</div>
                    <div class="engine-subtitle">Probe Microphones ¬∑ Multi-path Ray Tracing</div>
<div class="probe-paths-group">
                      <span class="probe-paths-label">Paths Traced</span>
                      <label class="toggle" for="probeGroundReflection">
                        <input type="checkbox" id="probeGroundReflection" checked />
                        <span>Ground Reflection</span>
                      </label>
                      <label class="toggle" for="probeWallReflections">
                        <input type="checkbox" id="probeWallReflections" checked />
                        <span>Wall Reflections</span>
                      </label>
<label class="toggle" for="probeBarrierDiffraction">
                        <input type="checkbox" id="probeBarrierDiffraction" checked />
                        <span>Barrier Diffraction</span>
                      </label>
<div class="equation-collapsible" data-equation="phasorSummation">
                        <div class="equation-header" role="button" tabindex="0">
                          <span class="equation-toggle">‚ñ∂</span>
                          <span>equation</span>
                        </div>
                        <div class="equation-content" hidden>
                          <div class="equation-main">$p = \sum_i p_i \cdot e^{j \phi_i}$</div>
                        </div>
                      </div>
                    </div>
                    <div class="probe-ground-group">
                      <span class="probe-paths-label">Ground Physics</span>
                      <label class="property-row property-row-stack">
                        <span>Ground Effect Model</span>
                        <select class="ui-inset" id="probeGroundModel">
                          <option value="impedance" selected>Physical Impedance</option>
                          <option value="iso9613">ISO 9613-2</option>
                        </select>
                      </label>
<label class="toggle" for="probeSommerfeldCorrection">
                        <input type="checkbox" id="probeSommerfeldCorrection" />
                        <span>Sommerfeld Correction</span>
                      </label>
                      <div class="equation-collapsible" data-equation="sommerfeld">
                        <div class="equation-header" role="button" tabindex="0">
                          <span class="equation-toggle">‚ñ∂</span>
                          <span>equation</span>
                        </div>
                        <div class="equation-content" hidden>
                          <div class="equation-main">$\Gamma_{sph} = \Gamma_{plane} + (1 - \Gamma_{plane}) \cdot F(w)$</div>
                        </div>
                      </div>
                      <label class="property-row property-row-stack">
                        <span>Impedance Model</span>
                        <select class="ui-inset" id="probeImpedanceModel">
                          <option value="delanyBazley">Delany-Bazley</option>
                          <option value="delanyBazleyMiki" selected>Delany-Bazley-Miki</option>
                        </select>
                      </label>
<div class="equation-collapsible" data-equation="impedance">
                        <div class="equation-header" role="button" tabindex="0">
                          <span class="equation-toggle">‚ñ∂</span>
                          <span>equation</span>
                        </div>
                        <div class="equation-content" hidden>
                          <div class="equation-main" id="impedanceEquation">$Z_n = 1 + 9.08(f/\sigma)^{-0.75} - j \cdot 11.9(f/\sigma)^{-0.73}$</div>
                        </div>
                      </div>
</div>
                    </div>
                  </div>

                </div>
              </div>

              <!-- Layers Panel -->
              <div class="settings-slide-panel" id="settingsPanelLayers" data-panel="layers">
                <div class="settings-panel-header">layers</div>
                <div class="settings-panel-content">
                  <div class="settings-section">
                    <div class="settings-title">visibility</div>
                    <label class="toggle" for="layerSources">
                      <input type="checkbox" id="layerSources" checked />
                      <span>Sources</span>
                    </label>
                    <label class="toggle" for="layerReceivers">
                      <input type="checkbox" id="layerReceivers" checked />
                      <span>Receivers</span>
                    </label>
                    <label class="toggle" for="layerPanels">
                      <input type="checkbox" id="layerPanels" checked />
                      <span>Measure Grids</span>
                    </label>
                    <label class="toggle" for="layerNoiseMap">
                      <input type="checkbox" id="layerNoiseMap" />
                      <span>Noise Map</span>
                    </label>
                    <label class="toggle" for="layerGrid">
                      <input type="checkbox" id="layerGrid" />
                      <span>Grid Overlay</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Floating UI overlay (non-blocking except for interactive elements). -->
      <div class="ui-layer">
        <header class="topbar topbar-floating">
<div class="topbar-left">
            <div class="topbar-actions">
<button class="ghost ui-button undo-redo-btn" id="undoButton" type="button" title="Undo the last change." aria-label="Undo">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M1 4v6h6"/>
                  <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>
                </svg>
              </button>
              <button class="ghost ui-button undo-redo-btn" id="redoButton" type="button" title="Redo the last change." aria-label="Redo">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M23 4v6h-6"/>
                  <path d="M20.49 15a9 9 0 1 1-2.13-9.36L23 10"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="topbar-center">
            <div class="brand brand--debossed">
              <div class="brand-icon" aria-hidden="true">
                <span class="brand-ring ring-1"></span>
                <span class="brand-ring ring-2"></span>
                <span class="brand-ring ring-3"></span>
                <span class="brand-core"></span>
              </div>
              <div class="brand-title">geonoise</div>
            </div>
          </div>
          <div class="topbar-right">
            <div class="control-module">
              <div class="run-group">
                <button
                  class="primary ui-button"
                  id="computeButton"
                  type="button"
                  title="Run propagation and update receiver/grid levels."
                >
                  Compute
                </button>
                <!-- Whole-scene noise map ("Mesh All"): compute a padded grid and render as a heatmap overlay. -->
                <button class="primary ui-button" id="meshButton" type="button" title="Generate a whole-scene noise map.">
                  Generate Map
                </button>
                <div class="status-chip status-chip--small" id="computeChip" aria-label="Compute status">Ready</div>
              </div>
              <div class="run-options is-hidden" aria-hidden="true">
                <label for="computePreference">CPU</label>
                <div class="select-shell">
                  <select class="ui-inset" id="computePreference">
                    <option value="cpu">CPU</option>
                  </select>
                </div>
              </div>
<!-- Lightweight feedback for heavy map computation (keeps UI responsive). -->
              <div class="map-toast" id="mapToast" role="status" aria-live="polite"></div>
            </div>
<button class="ghost ui-button" id="aboutButton" type="button" title="Model notes, assumptions, and limitations.">
              Details
            </button>
            <button class="ghost ui-button" id="authorButton" type="button" title="About GeoNoise">
              About
            </button>
          </div>
        </header>

        <!-- Layers popover removed - now integrated into Settings panel -->

        <!-- Bottom dock for creation tools. -->
        <div class="dock" id="dock">
          <!-- Collapsed FAB trigger -->
          <button class="dock-fab" id="dockFab" type="button" aria-label="Open tools" aria-expanded="false">
            <span class="dock-fab-icon">+</span>
          </button>
          <!-- Expandable tools container -->
          <div class="dock-expandable" id="dockExpandable">
            <div class="dock-stack">
              <div class="dock-label-stage" id="dockLabelStage" aria-hidden="true">
                <span id="dockLabelText"></span>
              </div>
              <div class="dock-tools" id="toolGrid">
              <button
                class="dock-button ui-button is-active"
                data-tool="select"
                data-label="Select Tool (V)"
                type="button"
                aria-label="Select (V)"
              >
                <span class="dock-label">V</span>
              </button>
              <button
                class="dock-button ui-button"
                data-tool="add-source"
                data-label="Add Source (S)"
                type="button"
                aria-label="Add Source (S)"
              >
                <span class="dock-label">S</span>
              </button>
              <button
                class="dock-button ui-button"
                data-tool="add-receiver"
                data-label="Add Receiver (R)"
                type="button"
                aria-label="Add Receiver (R)"
              >
                <span class="dock-label">R</span>
              </button>
              <button
                class="dock-button ui-button"
                data-tool="add-probe"
                data-label="Add Probe (P)"
                type="button"
                aria-label="Add Probe (P)"
              >
                <svg class="dock-icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    d="M12 3a3 3 0 0 0-3 3v6a3 3 0 0 0 6 0V6a3 3 0 0 0-3-3z"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M5 11a7 7 0 0 0 14 0M12 18v3M8 21h8"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
              <button
                class="dock-button ui-button"
                data-tool="add-barrier"
                data-label="Add Barrier (B)"
                type="button"
                aria-label="Add Barrier (B)"
              >
                <span class="dock-label">B</span>
              </button>
              <button
                class="dock-button ui-button"
                data-tool="add-building"
                data-label="Add Building (H)"
                type="button"
                aria-label="Add Building (H)"
              >
                <span class="dock-label">H</span>
              </button>
            <button
                class="dock-button ui-button"
                data-tool="add-panel"
                data-label="Add Measure Grid (G)"
                type="button"
                aria-label="Add Measure Grid (G)"
              >
                <span class="dock-label">G</span>
              </button>
              <button
                class="dock-button ui-button"
                data-tool="measure"
                data-label="Measuring Tape (M)"
                type="button"
                aria-label="Measuring Tape (M)"
              >
                <span class="dock-label">M</span>
              </button>
              <!-- Separator before map tools (hidden by default, shown by JS when ENABLE_MAPBOX is true) -->
              <div id="mapToolsSeparator" class="dock-separator" style="display: none; width: 1px; height: 24px; background: var(--border-soft); margin: 0 4px;"></div>
              <!-- Map overlay button (hidden by default, shown by JS when ENABLE_MAPBOX is true) -->
              <button
                class="dock-button ui-button"
                id="mapToggleButton"
                data-label="Toggle Map Overlay"
                type="button"
                aria-label="Toggle Map Overlay"
                title="Toggle Mapbox map overlay"
                style="display: none;"
              >
                <svg class="dock-icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"/>
                </svg>
              </button>
            </div>
          </div>
          </div>
          <div class="dock-instruction-bottom">Click to select. Drag to move. Shift+drag to duplicate.</div>
        </div>
        <!-- Contextual inspector shown only when a selection exists. -->
        <aside class="context-panel" id="contextPanel" aria-hidden="true">
          <div class="context-header" id="contextHeader">
            <div class="context-title-wrap">
              <div class="context-title" id="contextTitle">Select an element</div>
            </div>
            <div class="probe-actions">
              <button
                class="probe-pin ui-button"
                id="contextPin"
                type="button"
                aria-label="Pin inspector window"
                aria-pressed="false"
                title="Pin inspector (keeps panel open when clicking elsewhere)"
              >
                üìå
              </button>
              <button class="context-close ui-button" id="contextClose" type="button" aria-label="Close inspector">√ó</button>
            </div>
          </div>
          <div class="inspector-body">
            <div class="inspector-row">
              <span>Mode</span>
              <strong id="modeLabel">Select</strong>
            </div>
            <div class="inspector-row">
              <span>Snap</span>
              <strong>5 m</strong>
            </div>
            <div class="inspector-hint" id="selectionHint">Click an item to edit it.</div>
          </div>
          <div class="context-section">
            <div class="context-section-title">Properties</div>
            <div class="properties" id="propertiesBody">Select an item to edit its properties.</div>
          </div>
          <div class="context-section" id="panelStatsSection">
            <div class="context-section-title">Measure Grid Stats</div>
            <div class="panel-legend" id="panelLegend"></div>
            <div class="panel-stats" id="panelStats"></div>
          </div>
        </aside>

        <aside class="probe-panel" id="probePanel" aria-hidden="true">
          <div class="probe-header">
            <div class="probe-title" id="probeTitle">Probe</div>
            <div class="probe-actions">
              <button
                class="probe-freeze ui-button"
                id="probeFreeze"
                type="button"
                aria-label="Freeze probe snapshot"
                title="Freeze probe snapshot"
              >
                ‚ùÑ
              </button>
              <button
                class="probe-pin ui-button"
                id="probePin"
                type="button"
                aria-label="Pin monitoring window"
                aria-pressed="false"
                title="Pin monitoring window"
              >
                üìå
              </button>
              <button class="probe-close ui-button" id="probeClose" type="button" aria-label="Close probe inspector">
                x
              </button>
            </div>
          </div>
          <div class="probe-meta">
            <span>Frequency Response</span>
            <span class="probe-status" id="probeStatus">Idle</span>
          </div>
          <div class="probe-chart">
            <canvas id="probeChart"></canvas>
          </div>
          <div class="probe-footer">
            <span>Frequency (Hz)</span>
            <span>Amplitude (dB)</span>
          </div>
          <!-- Ray Visualization Card -->
          <div class="ray-viz-card" id="rayVizCard">
            <div class="ray-viz-header">
              <label class="ray-viz-toggle-label">
                <span>Show Traced Rays</span>
                <div class="ray-viz-toggle">
                  <input type="checkbox" id="rayVizToggle" />
                  <span class="ray-viz-toggle-track"></span>
                  <span class="ray-viz-toggle-thumb"></span>
                </div>
              </label>
            </div>
            <div class="ray-viz-content" id="rayVizContent">
              <div class="ray-viz-paths" id="rayVizPaths">
                <!-- Path rows will be populated dynamically -->
              </div>
              <div class="ray-viz-phase-info" id="rayVizPhaseInfo">
                <!-- Phase relationships will be populated dynamically -->
              </div>
              <div class="ray-viz-dominant" id="rayVizDominant">
                <!-- Dominant path info will be shown here -->
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <div class="modal" id="aboutModal" aria-hidden="true">
      <div class="modal-backdrop" data-modal-close></div>
      <div class="modal-card modal-plate" role="dialog" aria-modal="true" aria-labelledby="aboutTitle">
        <div class="modal-header">
          <div class="modal-title">
            <h2 id="aboutTitle">Details</h2>
            <p class="modal-subtitle">Real-time 2.5 dimension outdoor acoustic simulation</p>
          </div>
          <button class="modal-close ui-button" id="aboutClose" type="button" aria-label="Close">X</button>
        </div>
        <div class="about-tabs" role="tablist" aria-label="About tabs">
          <button
            class="about-tab is-active"
            type="button"
            role="tab"
            id="aboutTabCurrent"
            aria-selected="true"
            aria-controls="aboutPanelCurrent"
            data-about-tab="current"
          >
            Current
          </button>
          <button
            class="about-tab"
            type="button"
            role="tab"
            id="aboutTabEquations"
            aria-selected="false"
            aria-controls="aboutPanelEquations"
            data-about-tab="equations"
          >
            Full Equations
          </button>
          <button
            class="about-tab"
            type="button"
            role="tab"
            id="aboutTabEngines"
            aria-selected="false"
            aria-controls="aboutPanelEngines"
            data-about-tab="engines"
          >
            Engines
          </button>
        </div>
        <div
          class="about-panel is-active"
          role="tabpanel"
          id="aboutPanelCurrent"
          aria-labelledby="aboutTabCurrent"
          aria-hidden="false"
          data-about-panel="current"
        >
          <!-- Intro Section -->
          <div class="spec-section spec-section--full">
            <p class="section-intro">
              GeoNoise implements ISO 9613-based outdoor sound propagation with coherent phasor summation
              for multi-path interference modeling. All calculations are performed per octave band (63 Hz ‚Äì 16 kHz).
            </p>
<div class="formula-highlight formula-katex">
              $$L_p(f) = L_W(f) - A_{div} - A_{atm}(f) - A_{gr}(f) - A_{bar}(f)$$
            </div>
          </div>

          <!-- Expand All Button -->
          <button class="expand-all-btn" id="expandAllBtn" type="button">expand all</button>

          <!-- Collapsible Physics Sections -->
          <div class="spec-grid">

            <!-- Geometric Divergence -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">geometric divergence (A<sub>div</sub>)</span>
                    <span class="collapsible-subtitle">Spherical spreading: $A = 20\log_{10}(d) + 10\log_{10}(4\pi)$</span>
                  </div>
                </div>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
<div class="collapsible-body">
                <div class="collapsible-content">
                  <p class="spec-text">Point source spherical spreading models how sound energy spreads over an expanding sphere.</p>
                  <div class="formula-highlight formula-katex">$$A_{div} = 20\log_{10}(d) + 10\log_{10}(4\pi)$$</div>
                  <p class="spec-text">where d = 3D distance (m), 10¬∑log‚ÇÅ‚ÇÄ(4œÄ) ‚âà 10.99 dB for full spherical radiation.</p>
                  <p class="spec-text"><strong>Derivation:</strong> Power flux Œ¶ = W/(4œÄr¬≤), therefore L<sub>p</sub> = L<sub>W</sub> - 10¬∑log‚ÇÅ‚ÇÄ(4œÄr¬≤)</p>
                  <p class="spec-text" style="margin-top: 12px;"><strong>Cylindrical spreading</strong> (line sources): Uses 2œÄ instead of 4œÄ, as energy spreads over a cylinder's circumference rather than a sphere's surface area. Formula: A<sub>div</sub> = 10¬∑log‚ÇÅ‚ÇÄ(d) + 10¬∑log‚ÇÅ‚ÇÄ(2œÄ), where 10¬∑log‚ÇÅ‚ÇÄ(2œÄ) ‚âà 7.98 dB.</p>
                </div>
              </div>
            </div>

            <!-- Atmospheric Absorption -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">atmospheric absorption (A<sub>atm</sub>)</span>
                    <span class="collapsible-subtitle">ISO 9613-1: $A_{atm} = \alpha(f) \cdot d / 1000$</span>
                  </div>
                </div>
                <span class="standards-badge standards-badge--iso">ISO 9613-1</span>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
              <div class="collapsible-body">
                <div class="collapsible-content">
                  <p class="spec-text">Air absorbs sound energy through viscous, thermal, and molecular relaxation processes.</p>
                    <div class="formula-highlight formula-katex">$$A_{atm} = \alpha(f) \cdot \frac{d}{1000} \text{ dB}$$</div>

                    <p class="spec-text" style="margin-top: 12px;"><strong>ISO 9613-1:</strong> Calculates Œ± from temperature, humidity, and pressure.</p>
                  <div class="equation-pill" style="font-size: 12px;">
                    Œ± = Œ±<sub>cl</sub> + (b<sub>N</sub>¬∑f¬≤)/(f<sub>r,N</sub> + f¬≤/f<sub>r,N</sub>) + (b<sub>O</sub>¬∑f¬≤)/(f<sub>r,O</sub> + f¬≤/f<sub>r,O</sub>)
                  </div>
                  <p class="spec-text">The coefficient $\alpha$ combines classical losses with N‚ÇÇ and O‚ÇÇ molecular relaxation.</p>

                  <p class="spec-text" style="margin-top: 12px;"><strong>Simple:</strong> Uses the lookup table below at standard conditions (20¬∞C, 70% RH).</p>
                  <table class="physics-table">
                    <tr><th>63 Hz</th><th>125 Hz</th><th>250 Hz</th><th>500 Hz</th><th>1 kHz</th><th>2 kHz</th><th>4 kHz</th><th>8 kHz</th><th>16 kHz</th></tr>
                    <tr><td>0.1</td><td>0.4</td><td>1.0</td><td>1.9</td><td>3.7</td><td>9.7</td><td>33</td><td>117</td><td>392</td></tr>
                  </table>
                  <p class="spec-text" style="margin-top: 6px; font-size: 11px; color: var(--text-muted);">Values in dB/km</p>
                </div>
              </div>
            </div>

            <!-- Ground Effect -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">ground effect (A<sub>gr</sub>)</span>
                    <span class="collapsible-subtitle">$A_{gr} = A_s + A_r + A_m$ or two-ray interference</span>
                  </div>
                </div>
                <span class="standards-badge standards-badge--iso">ISO 9613-2</span>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
              <div class="collapsible-body">
                <div class="collapsible-content">
                  <p class="spec-text">Ground effect accounts for sound interaction with the ground surface. GeoNoise offers two models:</p>

                  <p class="spec-text" style="margin-top: 16px;"><strong>ISO 9613-2 Model (Standard Compliant):</strong></p>
                  <p class="spec-text">Divides the propagation path into three regions with frequency-dependent attenuation:</p>
                  <pre class="physics-diagram">  S ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ R
  ‚îÇ‚Üê‚îÄ‚îÄ As ‚îÄ‚îÄ‚Üí‚îÇ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Am ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ‚Üê‚îÄ‚îÄ Ar ‚îÄ‚îÄ‚Üí‚îÇ
  ‚îÇ  source  ‚îÇ      middle        ‚îÇ receiver ‚îÇ
  ‚îÇ  region  ‚îÇ      region        ‚îÇ  region  ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       dp,s         d - dp,s - dp,r      dp,r</pre>
<div class="formula-highlight formula-katex">
                    $$A_{gr} = A_s + A_r + A_m$$
                  </div>
                  <p class="spec-text">where:</p>
                  <ul class="spec-list" style="margin-left: 20px;">
                    <li><strong>A<sub>s</sub></strong> = source region effect (depends on h<sub>s</sub>, d<sub>p,s</sub>, G, frequency)</li>
                    <li><strong>A<sub>r</sub></strong> = receiver region effect (depends on h<sub>r</sub>, d<sub>p,r</sub>, G, frequency)</li>
                    <li><strong>A<sub>m</sub></strong> = middle region effect (depends on d, h<sub>s</sub>+h<sub>r</sub>, G, frequency)</li>
                    <li><strong>G</strong> = ground factor (0 = hard, 1 = soft, 0.5 = mixed)</li>
                    <li><strong>d<sub>p</sub></strong> = min(30√óh, d) ‚Äî characteristic distance for each region</li>
                  </ul>
                  <p class="spec-text">Coefficients from ISO 9613-2 Tables 3-4 vary by octave band (63 Hz ‚Äì 8 kHz).</p>

                  <p class="spec-text" style="margin-top: 16px;"><strong>Two-Ray Phasor Model (Physically Accurate):</strong></p>
                  <p class="spec-text">Models coherent interference between direct and ground-reflected paths:</p>
                  <pre class="physics-diagram">      S (source)
     /|\
    / | \  r‚ÇÅ = direct path
   /  |  \
  /   |hs \ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ R (receiver)
 /    |    \                  /
/     |     \      r‚ÇÇ       / hr
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ/‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  Ground (z=0)
             reflection point</pre>
                  <p class="spec-text"><strong>Path lengths:</strong></p>
<div class="formula-highlight formula-katex" style="font-size: 13px;">
                    $$r_1 = \sqrt{d^2 + (h_s - h_r)^2} \quad | \quad r_2 = \sqrt{d^2 + (h_s + h_r)^2}$$
                  </div>
                  <p class="spec-text"><strong>Delany-Bazley normalized impedance:</strong></p>
                  <div class="equation-pill" style="font-size: 12px;">
                    Z<sub>n</sub> = 1 + 9.08(f/œÉ)<sup>-0.75</sup> + j¬∑11.9(f/œÉ)<sup>-0.73</sup>
                  </div>
                  <p class="spec-text">where œÉ = flow resistivity (hard: 200,000, soft: 20,000 Pa¬∑s/m¬≤)</p>
                  <p class="spec-text"><strong>Coherent ground effect:</strong></p>
<div class="formula-highlight formula-katex">
                    $$A_{gr} = -20\log_{10}\left|1 + \Gamma \cdot \frac{r_1}{r_2} \cdot e^{jk(r_2 - r_1)}\right|$$
                  </div>
                  <p class="spec-text">This captures constructive/destructive interference (ground dip phenomenon).</p>

                  <p class="spec-text" style="margin-top: 16px;"><strong>Model Comparison:</strong></p>
                  <table class="physics-table">
                    <tr><th>Aspect</th><th>ISO 9613-2</th><th>Two-Ray Phasor</th></tr>
                    <tr><td>Standards</td><td>Compliant</td><td>Physics-based</td></tr>
                    <tr><td>Frequency</td><td>Per-band coefficients</td><td>Wavelength-based phase</td></tr>
                    <tr><td>Interference</td><td>Empirical approximation</td><td>Full wave interference</td></tr>
                    <tr><td>Ground dip</td><td>Not modeled</td><td>Naturally captured</td></tr>
                    <tr><td>Boost (A<sub>gr</sub> &lt; 0)</td><td>Allowed</td><td>Allowed</td></tr>
                  </table>
                </div>
              </div>
            </div>

            <!-- Barrier Diffraction -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">barrier diffraction</span>
                    <span class="collapsible-subtitle">Maekawa: $A_{bar} = 10\log_{10}(3 + 20N)$</span>
                  </div>
                </div>
                <span class="standards-badge standards-badge--empirical">Maekawa</span>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
              <div class="collapsible-body">
                <div class="collapsible-content">
                  <p class="spec-text">Sound diffracts over and around barriers. Attenuation depends on the path difference Œ¥.</p>

                  <p class="spec-text"><strong>Over-Top Diffraction (vertical):</strong></p>
                  <pre class="physics-diagram">    S                    R
     \                  /
      \   Œ¥ = A+B-d   /
       A ‚îÄ‚îÄ‚Üí ‚óè ‚Üê‚îÄ‚îÄ B
             ‚îÇ
      ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê   Barrier</pre>
                  <div class="formula-highlight formula-katex">$$\delta = A + B - d \quad | \quad N = \frac{2\delta f}{c}$$</div>
                  <p class="spec-text"><strong>Insertion loss:</strong></p>
                  <div class="formula-highlight formula-katex">$$A_{bar} = 10\log_{10}(3 + 20N) \quad \text{capped at 20-25 dB}$$</div>

                  <p class="spec-text" style="margin-top: 16px;"><strong>Side Diffraction (horizontal):</strong></p>
                  <p class="spec-text">Sound can also bend around the ends of finite-length barriers:</p>
                  <pre class="physics-diagram">      ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  Barrier (top view)
     ‚óè                  ‚óè
   Left               Right
   Edge               Edge
     ‚Üë                  ‚Üë
  S ‚îÄ‚îò                  ‚îî‚îÄ R
(around left)      (around right)</pre>
                  <p class="spec-text">Path difference for side: $\delta = |S \to Edge| + |Edge \to R| - |S \to R|$</p>
                  <p class="spec-text">The path with <strong>minimum Œ¥</strong> (over-top or around sides) determines the effective attenuation.</p>

                  <p class="spec-text" style="margin-top: 16px;"><strong>Side Diffraction Toggle:</strong></p>
                  <table class="physics-table">
                    <tr><th>Mode</th><th>Behavior</th></tr>
                    <tr><td><strong>Off</strong></td><td>ISO 9613-2 infinite barrier assumption. Only over-top diffraction.</td></tr>
                    <tr><td><strong>Auto</strong></td><td>Enable side diffraction for barriers &lt; 50m (recommended default).</td></tr>
                    <tr><td><strong>On</strong></td><td>Always compute side diffraction for all barriers.</td></tr>
                  </table>
<p class="spec-text" style="margin-top: 12px;"><em>Low frequencies diffract easily ‚Üí less attenuation. High frequencies are blocked effectively.</em></p>
                  </div>
                </div>
              </div>

            <!-- Wall Reflections -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">wall reflections</span>
                    <span class="collapsible-subtitle">Image source method: $|\Gamma| \approx 0.9$</span>
                  </div>
                </div>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
              <div class="collapsible-body">
                <div class="collapsible-content">
                  <p class="spec-text">Reflections from building walls computed using virtual image sources:</p>
                  <pre class="physics-diagram">         Wall
           ‚îÇ
   S ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚óè‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ R
    \      ‚îÇ      /
     \     ‚îÇ     /
      S'   ‚îÇ   (S' = mirror of S across wall)</pre>
                  <div class="formula-highlight formula-katex">$$|\Gamma| \approx 0.9 \text{ per reflection (10% absorption)}$$</div>
                  <p class="spec-text">Reflections are validated for line-of-sight and checked against other buildings.</p>
                </div>
              </div>
            </div>

            <!-- Coherent Summation -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">coherent phasor summation</span>
                    <span class="collapsible-subtitle">$p_{total} = \sum_i p_i \cdot e^{j\phi_i}$</span>
                  </div>
                </div>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
              <div class="collapsible-body">
                <div class="collapsible-content">
                  <p class="spec-text">Multiple paths from the <strong>same source</strong> are summed with phase (capturing interference):</p>
<div class="formula-highlight formula-katex">
                      $$p_{total} = \sum_i p_i \cdot e^{j\phi_i} \quad \text{where } \phi_i = -k \cdot d_i + \phi_{reflection}$$
                    </div>
                  <p class="spec-text">This captures:</p>
                  <ul class="spec-list">
                    <li>Constructive interference (paths in-phase ‚Üí +6 dB)</li>
                    <li>Destructive interference (paths out-of-phase ‚Üí deep nulls)</li>
                    <li>Ground dip phenomenon at specific frequencies</li>
                    <li>Comb filtering from wall reflections</li>
                  </ul>
                  <p class="spec-text" style="margin-top: 10px;">Multiple <strong>sources</strong> are summed energetically (incoherent):</p>
                  <div class="formula-highlight formula-katex">$$L_{p,total} = 10\log_{10}\left[ \sum_j 10^{L_{p,j}/10} \right]$$</div>
                </div>
              </div>
            </div>

            <!-- Accuracy & Limitations -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">accuracy & limitations</span>
                    <span class="collapsible-subtitle">Expected precision and model assumptions</span>
                  </div>
                </div>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
              <div class="collapsible-body">
                <div class="collapsible-content">
                  <div class="accuracy-indicator">
                    <div class="accuracy-dot" style="background: #f5a623;"></div>
                    <span class="accuracy-text">Accuracy pending measurements and validation</span>
                  </div>
                  <p class="spec-text" style="margin-top: 12px;"><strong>Known Limitations:</strong></p>
                  <ul class="limitations-list">
                    <li>Flat terrain assumed (no topography effects)</li>
                    <li>Neutral atmosphere (no temperature/wind refraction)</li>
                    <li>First-order wall reflections only</li>
                    <li>2.5D geometry (vertical plane diffraction)</li>
                    <li>Homogeneous ground (single type per scene)</li>
                  </ul>
                  <p class="spec-text" style="margin-top: 12px;"><strong>Numerical Guards:</strong></p>
                  <ul class="limitations-list">
                    <li>Distance floor: d<sub>min</sub> = 0.1m to prevent division by zero</li>
                    <li>Angle limits: cos Œ∏ clamped for grazing incidence</li>
                    <li>Impedance cap: |Z| bounded to avoid runaway coefficients</li>
                    <li>Level floor: -100 dB (acoustic silence threshold)</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- References -->
            <div class="collapsible-section" data-collapsible>
              <div class="collapsible-header" tabindex="0" role="button" aria-expanded="false">
                <div class="collapsible-header-left">
                  <div class="collapsible-title-group">
                    <span class="collapsible-title">references</span>
                    <span class="collapsible-subtitle">Standards and academic sources</span>
                  </div>
                </div>
                <div class="collapsible-chevron">‚ñº</div>
              </div>
              <div class="collapsible-divider"></div>
              <div class="collapsible-body">
                <div class="collapsible-content">
                  <ul class="references-list">
                    <li data-ref="[1]">ISO 9613-1:1993 ‚Äî Acoustics ‚Äî Attenuation of sound during propagation outdoors ‚Äî Part 1: Calculation of absorption by atmosphere</li>
                    <li data-ref="[2]">ISO 9613-2:1996 ‚Äî Acoustics ‚Äî Attenuation of sound during propagation outdoors ‚Äî Part 2: General method of calculation</li>
                    <li data-ref="[3]">Maekawa, Z. (1968). "Noise reduction by screens." Applied Acoustics, 1(3), 157-173</li>
                    <li data-ref="[4]">Delany, M.E. & Bazley, E.N. (1970). "Acoustical properties of fibrous absorbent materials." Applied Acoustics, 3(2), 105-116</li>
                    <li data-ref="[5]">Pierce, A.D. (1981). "Acoustics: An Introduction to Its Physical Principles and Applications." McGraw-Hill</li>
                  </ul>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div
          class="about-panel"
          role="tabpanel"
          id="aboutPanelEquations"
          aria-labelledby="aboutTabEquations"
          aria-hidden="true"
          data-about-panel="equations"
        >
          <div class="spec-grid equations-grid">
            <div class="spec-section spec-section--full">
              <div class="spec-heading">CORE LEVELS</div>
              <div class="spec-tray">
                <div class="spec-text">Overall level at receiver:</div>
                <div class="equation-pill">
                  L<sub>p</sub> = L<sub>W</sub> - A<sub>div</sub> - A<sub>atm</sub> - A<sub>gr</sub> - A<sub>bar</sub>
                </div>
                <div class="spec-text">Energetic summation of multiple sources:</div>
                <div class="equation-pill">
                  L<sub>sum</sub> = 10 log<sub>10</sub>( &Sigma; 10<sup>L<sub>i</sub>/10</sup> )
                </div>
                <div class="spec-text">Sound power conversions:</div>
                <div class="equation-pill">L<sub>W</sub> = 10 log<sub>10</sub>(P / 10<sup>-12</sup>)</div>
                <div class="equation-pill">P = 10<sup>-12</sup> &#183; 10<sup>L<sub>W</sub>/10</sup></div>
              </div>
            </div>
            <div class="spec-section">
              <div class="spec-heading">GEOMETRY</div>
              <div class="spec-tray">
                <div class="spec-text">Plan distance:</div>
                <div class="equation-pill">d<sub>2D</sub> = &radic;((x<sub>2</sub>-x<sub>1</sub>)<sup>2</sup> + (y<sub>2</sub>-y<sub>1</sub>)<sup>2</sup>)</div>
                <div class="spec-text">3D distance:</div>
                <div class="equation-pill">
                  d<sub>3D</sub> = &radic;((x<sub>2</sub>-x<sub>1</sub>)<sup>2</sup> + (y<sub>2</sub>-y<sub>1</sub>)<sup>2</sup> + (z<sub>2</sub>-z<sub>1</sub>)<sup>2</sup>)
                </div>
                <div class="spec-text">Direct path used for diffraction reference:</div>
                <div class="equation-pill">d<sub>direct</sub> = &radic;(d<sub>2D</sub><sup>2</sup> + (h<sub>s</sub> - h<sub>r</sub>)<sup>2</sup>)</div>
              </div>
            </div>
<div class="spec-section">
              <div class="spec-heading">SPREADING</div>
              <div class="spec-tray">
                <div class="spec-text">Point source (spherical):</div>
                <div class="equation-pill">A<sub>div</sub> = 20 log<sub>10</sub>(d) + 10 log<sub>10</sub>(4œÄ)</div>
                <div class="spec-text">Line source (cylindrical):</div>
                <div class="equation-pill">A<sub>div</sub> = 10 log<sub>10</sub>(d) + 10 log<sub>10</sub>(2œÄ)</div>
              </div>
            </div>
            <div class="spec-section spec-section--full">
              <div class="spec-heading">ATMOSPHERIC ABSORPTION</div>
              <div class="spec-tray">
                <div class="spec-text">Path loss:</div>
                <div class="equation-pill">A<sub>atm</sub> = &alpha; &#183; d</div>
                <div class="spec-text">Speed of sound and wavelength:</div>
                <div class="equation-pill">c = 331.3 + 0.606 T<sub>C</sub></div>
                <div class="equation-pill">&lambda; = c / f</div>
                <div class="spec-text">ISO 9613-1 absorption coefficient:</div>
                <div class="equation-block">
                  <div>&alpha; = 8.686 f<sup>2</sup> [ (1.84e-11 (p/p<sub>0</sub>)<sup>-1</sup> (T/T<sub>0</sub>)<sup>1/2</sup>)</div>
                  <div>+ (T/T<sub>0</sub>)<sup>-2.5</sup> (0.01275 e<sup>-2239.1/T</sup> (f<sub>r,O</sub>/(f<sub>r,O</sub><sup>2</sup> + f<sup>2</sup>))</div>
                  <div>+ 0.1068 e<sup>-3352/T</sup> (f<sub>r,N</sub>/(f<sub>r,N</sub><sup>2</sup> + f<sup>2</sup>))) ]</div>
                </div>
                <div class="equation-block">
                  <div>C = -6.8346 (T<sub>01</sub>/T)<sup>1.261</sup> + 4.6151</div>
                  <div>p<sub>sat</sub> = p<sub>0</sub> &#183; 10<sup>C</sup>, h = RH &#183; p<sub>sat</sub> / p</div>
                  <div>f<sub>r,O</sub> = (p/p<sub>0</sub>) [24 + 4.04e4 h ((0.02 + h)/(0.391 + h))]</div>
                  <div>f<sub>r,N</sub> = (p/p<sub>0</sub>) (T/T<sub>0</sub>)<sup>-1/2</sup> [9 + 280 h e<sup>-4.17((T/T<sub>0</sub>)<sup>-1/3</sup> - 1)</sup>]</div>
                </div>
              </div>
            </div>
<div class="spec-section spec-section--full">
              <div class="spec-heading">GROUND EFFECTS</div>
              <div class="spec-tray">
                <div class="spec-text">ISO 9613-2 Tables 3-4 (per-band, primary model):</div>
                <div class="equation-pill">
                  A<sub>gr</sub> = A<sub>s</sub> + A<sub>r</sub> + A<sub>m</sub>
                </div>
                <div class="equation-block">
                  <div>A<sub>s</sub> = a'(f) + b'(f)¬∑G¬∑log(h<sub>s</sub>) + c'(f)¬∑G¬∑log(d<sub>p,s</sub>) + d'(f)¬∑G</div>
                  <div>A<sub>r</sub> = a'(f) + b'(f)¬∑G¬∑log(h<sub>r</sub>) + c'(f)¬∑G¬∑log(d<sub>p,r</sub>) + d'(f)¬∑G</div>
                  <div>A<sub>m</sub> = a(f)¬∑q + b(f)¬∑(1-G)¬∑q &nbsp; where q = max(0, 1 - 30(h<sub>s</sub>+h<sub>r</sub>)/d)</div>
                  <div>d<sub>p</sub> = min(30¬∑h, d) &nbsp;&nbsp; G = ground factor (0=hard, 0.5=mixed, 1=soft)</div>
                </div>
                <div class="spec-text">Two-ray phasor geometry:</div>
                <div class="equation-pill">
                  r<sub>1</sub> = &radic;(d<sup>2</sup> + (h<sub>s</sub> - h<sub>r</sub>)<sup>2</sup>),
                  r<sub>2</sub> = &radic;(d<sup>2</sup> + (h<sub>s</sub> + h<sub>r</sub>)<sup>2</sup>)
                </div>
                <div class="spec-text">Normalized impedance ‚Äî Delany-Bazley (0.01 &lt; f/œÉ &lt; 1.0):</div>
                <div class="equation-pill">
                  &zeta; = 1 + 9.08 (f/&sigma;)<sup>-0.75</sup> - j 11.9 (f/&sigma;)<sup>-0.73</sup>
                </div>
                <div class="spec-text">Miki extension (f/œÉ &gt; 1.0):</div>
                <div class="equation-pill">
                  &zeta; = 1 + 5.50 (f/&sigma;)<sup>-0.632</sup> - j 8.43 (f/&sigma;)<sup>-0.632</sup>
                </div>
                <div class="spec-text">Reflection coefficient (locally reacting):</div>
                <div class="equation-pill">
                  &Gamma; = (&zeta; cos&#952; - 1) / (&zeta; cos&#952; + 1)
                </div>
                <div class="spec-text">Two-ray ratio and attenuation:</div>
                <div class="equation-block">
                  <div>ratio = 1 + &Gamma; (r<sub>1</sub>/r<sub>2</sub>) e<sup>-jk(r<sub>2</sub> - r<sub>1</sub>)</sup></div>
                  <div>A<sub>gr</sub> = -20 log<sub>10</sub>(max(|ratio|, 10<sup>-6</sup>))</div>
                </div>
              </div>
            </div>
            <div class="spec-section spec-section--full">
              <div class="spec-heading">BARRIER DIFFRACTION</div>
              <div class="spec-tray">
                <div class="spec-text">Thin barrier (single edge, cap 20 dB):</div>
                <div class="equation-block">
                  <div>A = &radic;(d(S,I)<sup>2</sup> + (h<sub>b</sub> - h<sub>s</sub>)<sup>2</sup>)</div>
                  <div>B = &radic;(d(I,R)<sup>2</sup> + (h<sub>b</sub> - h<sub>r</sub>)<sup>2</sup>)</div>
                  <div>&delta; = A + B - d<sub>direct</sub></div>
                </div>
                <div class="spec-text">Thick barrier / building (double edge, cap 25 dB):</div>
                <div class="equation-block">
                  <div>A = &radic;(d(S,I<sub>in</sub>)<sup>2</sup> + (h<sub>b</sub> - h<sub>s</sub>)<sup>2</sup>)</div>
                  <div>B = d(I<sub>in</sub>, I<sub>out</sub>) &nbsp; (roof width)</div>
                  <div>C = &radic;(d(I<sub>out</sub>,R)<sup>2</sup> + (h<sub>b</sub> - h<sub>r</sub>)<sup>2</sup>)</div>
                  <div>&delta; = A + B + C - d<sub>direct</sub></div>
                </div>
                <div class="spec-text">Maekawa-style insertion loss:</div>
                <div class="equation-pill">N = 2&delta; / &lambda;</div>
                <div class="equation-pill">Thin: A<sub>bar</sub> = 10 log<sub>10</sub>(3 + 20N) &nbsp; cap 20 dB</div>
                <div class="equation-pill">Thick: A<sub>bar</sub> = 10 log<sub>10</sub>(3 + 40N) &nbsp; cap 25 dB</div>
                <div class="spec-text">Blocked path total (ISO 9613-2 ¬ß7.4 additive):</div>
                <div class="equation-pill">A<sub>total</sub> = A<sub>div</sub> + A<sub>atm</sub>(d<sub>actual</sub>) + A<sub>bar</sub> + A<sub>gr</sub></div>
              </div>
            </div>
            <div class="spec-section">
              <div class="spec-heading">WEIGHTING</div>
              <div class="spec-tray">
                <div class="spec-text">Octave-band weighting:</div>
                <div class="equation-pill">L<sub>A</sub> = L<sub>band</sub> + A(f)</div>
                <div class="equation-pill">L<sub>C</sub> = L<sub>band</sub> + C(f)</div>
              </div>
            </div>
          </div>
        </div>
        <div
          class="about-panel"
          role="tabpanel"
          id="aboutPanelEngines"
          aria-labelledby="aboutTabEngines"
          aria-hidden="true"
          data-about-panel="engines"
        >
          <div class="spec-section spec-section--full">
            <p class="section-intro">
              GeoNoise uses two calculation engines optimized for different use cases.
              Understanding when each is applied helps interpret results correctly.
            </p>
          </div>

          <div class="spec-grid equations-grid">
            <div class="spec-section">
              <div class="spec-heading">GRID ENGINE</div>
              <div class="spec-tray">
                <div class="spec-text"><strong>Used for:</strong> Measure Grids, Receivers, Noise Maps</div>
                <div class="spec-text" style="margin-top: 8px;"><strong>Path Finding:</strong></div>
                <ul class="spec-list" style="margin-left: 16px;">
                  <li>Single direct path per source-receiver pair</li>
                  <li>Checks for barrier occlusion ‚Üí computes diffraction</li>
                  <li>Ground effect via A<sub>gr</sub> model (ISO or Two-Ray)</li>
                </ul>
                <div class="spec-text" style="margin-top: 8px;"><strong>Ground Effect Models:</strong></div>
                <ul class="spec-list" style="margin-left: 16px;">
                  <li><strong>ISO 9613-2:</strong> Empirical per-band coefficients (no interference)</li>
                  <li><strong>Two-Ray:</strong> Phasor interference between direct + ground reflection</li>
                </ul>
                <div class="spec-text" style="margin-top: 8px;"><strong>Summation:</strong></div>
                <div class="equation-pill">L = 10¬∑log‚ÇÅ‚ÇÄ(Œ£ 10<sup>L·µ¢/10</sup>)</div>
                <div class="spec-text">Energy (power) summation across sources.</div>
                <div class="spec-text" style="margin-top: 8px;"><strong>Trade-off:</strong> Fast computation for heat maps. With Two-Ray enabled, captures ground dip. No wall reflections or multi-path beyond ground.</div>
              </div>
            </div>

            <div class="spec-section">
              <div class="spec-heading">PROBE ENGINE</div>
              <div class="spec-tray">
                <div class="spec-text"><strong>Used for:</strong> Probe microphones only</div>
                <div class="spec-text" style="margin-top: 8px;"><strong>Path Finding (Ray Tracing):</strong></div>
                <ul class="spec-list" style="margin-left: 16px;">
                  <li>Direct path</li>
                  <li>Ground-reflected path (specular reflection)</li>
                  <li>Wall reflections (first-order image sources)</li>
                  <li>Side diffraction around barrier edges</li>
                  <li>Over-top diffraction</li>
                </ul>
                <div class="spec-text" style="margin-top: 8px;"><strong>Summation:</strong></div>
                <div class="equation-pill">p = Œ£ p·µ¢¬∑e<sup>jœÜ·µ¢</sup> &nbsp; where œÜ = -k¬∑d</div>
                <div class="spec-text">Phasor (coherent) summation with phase from path length.</div>
                <div class="spec-text" style="margin-top: 8px;"><strong>Trade-off:</strong> Full multi-path interference (ground dip, wall comb filtering, diffraction patterns). Slower, used only for point analysis.</div>
              </div>
            </div>

            <div class="spec-section spec-section--full">
              <div class="spec-heading">CALCULATION ARCHITECTURE</div>
              <div class="spec-tray">
                <pre class="physics-diagram">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      GeoNoise Calculation Flow                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                 ‚îÇ
‚îÇ  ‚îÇ   Sources    ‚îÇ              ‚îÇ  Receivers   ‚îÇ                 ‚îÇ
‚îÇ  ‚îÇ (with Lw/f)  ‚îÇ              ‚îÇ    Grids     ‚îÇ                 ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ    Probes    ‚îÇ                 ‚îÇ
‚îÇ         ‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îÇ
‚îÇ         ‚ñº                             ‚îÇ                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îÇ                    PATH FINDING                              ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îÇ                                                              ‚îÇ
‚îÇ  ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ   GRID ENGINE       ‚îÇ    ‚îÇ      PROBE ENGINE           ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ                     ‚îÇ    ‚îÇ                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ  ‚Ä¢ Single path      ‚îÇ    ‚îÇ  ‚Ä¢ Ray tracing (multi-path) ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ  ‚Ä¢ Direct + best    ‚îÇ    ‚îÇ  ‚Ä¢ Ground reflection rays   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ    diffraction      ‚îÇ    ‚îÇ  ‚Ä¢ Wall reflection rays     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ  ‚Ä¢ A_gr handles     ‚îÇ    ‚îÇ  ‚Ä¢ Side diffraction paths   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ    ground effect    ‚îÇ    ‚îÇ  ‚Ä¢ Used for: Probes only    ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚îÇ             ‚îÇ                              ‚îÇ                 ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                ‚ñº                              ‚ñº                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îÇ                 ATTENUATION (ISO 9613-2)                     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îÇ   For each path, apply per-band:                             ‚îÇ
‚îÇ  ‚îÇ   ‚Ä¢ A_div  (geometric spreading)                             ‚îÇ
‚îÇ  ‚îÇ   ‚Ä¢ A_atm  (atmospheric absorption)                          ‚îÇ
‚îÇ  ‚îÇ   ‚Ä¢ A_gr   (ground effect ‚Äî ISO or Two-Ray phasor)           ‚îÇ
‚îÇ  ‚îÇ   ‚Ä¢ A_bar  (barrier diffraction if blocked)                  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                              ‚îÇ                                  ‚îÇ
‚îÇ                              ‚ñº                                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îÇ                    SUMMATION                                 ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚îÇ                                                              ‚îÇ
‚îÇ  ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ   INCOHERENT        ‚îÇ    ‚îÇ      COHERENT (Phasor)      ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ                     ‚îÇ    ‚îÇ                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ  L = 10¬∑log‚ÇÅ‚ÇÄ(Œ£10^  ‚îÇ    ‚îÇ  p = Œ£ p·µ¢¬∑e^(jœÜ·µ¢)          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ          (L·µ¢/10))   ‚îÇ    ‚îÇ  L = 20¬∑log‚ÇÅ‚ÇÄ|p|            ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ                     ‚îÇ    ‚îÇ                             ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ  ‚Ä¢ Power summation  ‚îÇ    ‚îÇ  ‚Ä¢ Phase-aware interference ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ  ‚Ä¢ Fast, stable     ‚îÇ    ‚îÇ  ‚Ä¢ Captures nulls & peaks   ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îÇ  ‚Ä¢ Used by: Grids   ‚îÇ    ‚îÇ  ‚Ä¢ Used by: Probes          ‚îÇ ‚îÇ
‚îÇ  ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚îÇ                                                              ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</pre>
              </div>
            </div>

            <div class="spec-section spec-section--full">
              <div class="spec-heading">COMPARISON SUMMARY</div>
              <div class="spec-tray">
                <table class="physics-table">
                  <tr>
                    <th>Aspect</th>
                    <th>Grid Engine</th>
                    <th>Probe Engine</th>
                  </tr>
                  <tr>
                    <td>Path count</td>
                    <td>1 per source</td>
                    <td>Multiple (ray traced)</td>
                  </tr>
                  <tr>
                    <td>Ground effect</td>
                    <td>ISO or Two-Ray phasor</td>
                    <td>Two-ray phasor</td>
                  </tr>
                  <tr>
                    <td>Wall reflections</td>
                    <td>No</td>
                    <td>Yes (first-order)</td>
                  </tr>
                  <tr>
                    <td>Summation</td>
                    <td>Incoherent (power)</td>
                    <td>Coherent (phasor)</td>
                  </tr>
                  <tr>
                    <td>Ground interference</td>
                    <td>With Two-Ray only</td>
                    <td>Always (if enabled)</td>
                  </tr>
                  <tr>
                    <td>Multi-path interference</td>
                    <td>No (walls, etc.)</td>
                    <td>Yes (walls, diffraction)</td>
                  </tr>
                  <tr>
                    <td>Ground dip</td>
                    <td>With Two-Ray enabled</td>
                    <td>Naturally emerges</td>
                  </tr>
                  <tr>
                    <td>Performance</td>
                    <td>Fast (grid-parallel)</td>
                    <td>Slower (per-probe)</td>
                  </tr>
                  <tr>
                    <td>Output</td>
                    <td>Heatmap, single dB value</td>
                    <td>Frequency response curve</td>
                  </tr>
                </table>
              </div>
            </div>

            <div class="spec-section spec-section--full">
              <div class="spec-heading">WHY TWO ENGINES?</div>
              <div class="spec-tray">
                <p class="spec-text">
                  <strong>Grids/Receivers</strong> need to compute thousands of points quickly for heat maps.
                  Using multi-path ray tracing everywhere would be prohibitively slow.
                  The ISO 9613-2 single-path approach is designed for this: it's an engineering standard
                  optimized for outdoor prediction across large areas with acceptable accuracy.
                </p>
                <p class="spec-text" style="margin-top: 12px;">
                  <strong>Probes</strong> are point measurements where you want detailed frequency response.
                  Ray tracing + coherent summation reveals interference effects invisible to incoherent methods:
                  the ground dip phenomenon, wall reflection comb filtering, and barrier edge diffraction patterns.
                </p>
                <p class="spec-text" style="margin-top: 12px;">
                  Both engines share the same <strong>ISO 9613-2 attenuation functions</strong> for A<sub>div</sub>,
                  A<sub>atm</sub>, A<sub>gr</sub>, and A<sub>bar</sub>. The difference is in <em>how many paths</em>
                  are traced and <em>how they're combined</em> at the receiver.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="./main.js"></script>

    <!-- Mapbox Token Modal -->
    <div class="modal" id="mapboxTokenModal" aria-hidden="true">
      <div class="modal-backdrop" data-modal-close></div>
      <div class="modal-card modal-plate" role="dialog" aria-modal="true" aria-labelledby="mapboxTokenTitle" style="width: min(450px, 90vw);">
        <div class="modal-header">
          <div class="modal-title">
            <h2 id="mapboxTokenTitle">Configure Mapbox</h2>
            <p class="modal-subtitle">Enter your Mapbox access token to enable map overlays</p>
          </div>
          <button class="modal-close ui-button" id="mapboxTokenClose" type="button" aria-label="Close">X</button>
        </div>
        <div class="spec-tray" style="padding: 16px;">
          <div style="margin-bottom: 16px;">
            <label for="mapboxTokenInput" style="display: block; font-size: 13px; font-weight: 500; color: var(--text); margin-bottom: 8px;">
              Access Token
            </label>
            <input
              type="text"
              id="mapboxTokenInput"
              placeholder="pk.eyJ1Ijoi..."
              style="
                width: 100%;
                padding: 10px 12px;
                font-size: 13px;
                font-family: monospace;
                border: none;
                border-radius: 8px;
                background: var(--surface-lo);
                box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
                color: var(--text);
                outline: none;
              "
            />
          </div>
          <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 16px;">
            Get your free token at <a href="https://account.mapbox.com/access-tokens/" target="_blank" rel="noopener noreferrer" style="color: var(--accent);">mapbox.com</a>
            <br>Your token is stored locally in your browser.
          </div>
          <div style="display: flex; gap: 8px; justify-content: flex-end;">
            <button
              class="ui-button"
              id="mapboxTokenClear"
              type="button"
              style="padding: 8px 16px; font-size: 13px;"
            >
              Clear
            </button>
            <button
              class="ui-button"
              id="mapboxTokenSave"
              type="button"
              style="padding: 8px 16px; font-size: 13px; background: linear-gradient(145deg, var(--accent), var(--accent)); color: white;"
            >
              Save & Enable Map
            </button>
          </div>
          <div id="mapboxTokenError" style="display: none; margin-top: 12px; padding: 8px 12px; border-radius: 6px; background: rgba(220, 53, 69, 0.1); color: #dc3545; font-size: 12px;"></div>
          <div id="mapboxTokenSuccess" style="display: none; margin-top: 12px; padding: 8px 12px; border-radius: 6px; background: rgba(40, 167, 69, 0.1); color: #28a745; font-size: 12px;"></div>
        </div>
      </div>
    </div>

    <!-- Author/About Modal -->
    <div class="modal" id="authorModal" aria-hidden="true">
      <div class="modal-backdrop" data-modal-close></div>
      <div class="modal-card modal-plate" role="dialog" aria-modal="true" aria-labelledby="authorTitle" style="width: min(400px, 90vw);">
        <div class="modal-header">
          <div class="modal-title">
            <h2 id="authorTitle">About GeoNoise</h2>
          </div>
          <button class="modal-close ui-button" id="authorClose" type="button" aria-label="Close">X</button>
        </div>
<div class="spec-tray" style="text-align: center;">
<div style="font-size: 18px; font-weight: 600; color: var(--text); margin-bottom: 4px;">GeoNoise</div>
          <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 16px;">Version 0.7.0</div>
          <div style="height: 1px; background: var(--border-soft); margin: 12px 0;"></div>
          <div style="font-size: 13px; color: var(--text-soft); margin-bottom: 8px;">Developed by</div>
<div style="font-size: 15px; font-weight: 600; color: var(--text); margin-bottom: 12px;">Sergio Pe√±a</div>
          <a
            href="https://www.linkedin.com/in/sergio-pena-a8108684/"
            target="_blank"
            rel="noopener noreferrer"
            style="
              display: inline-flex;
              align-items: center;
              justify-content: center;
              gap: 8px;
              padding: 10px 20px;
              border-radius: 999px;
              background: linear-gradient(145deg, var(--surface-hi), var(--surface-lo));
              box-shadow: var(--shadow-raised);
              color: var(--text);
              font-size: 13px;
              font-weight: 600;
              text-decoration: none;
              transition: transform 120ms ease, box-shadow 120ms ease;
            "
          >
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
            Connect on LinkedIn
          </a>
          <div style="height: 1px; background: var(--border-soft); margin: 16px 0 12px;"></div>
          <div style="font-size: 11px; color: var(--text-muted); margin-bottom: 12px;">
            Built as a fun experiment and practice experience with
          </div>
          <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-bottom: 12px;">
            <span style="
              padding: 4px 10px;
              border-radius: 999px;
              background: linear-gradient(145deg, var(--surface-hi), var(--surface-lo));
              box-shadow: 2px 2px 4px var(--shadow-dark), -2px -2px 4px var(--shadow-light);
              font-size: 10px;
              font-weight: 600;
              color: var(--text-soft);
            ">Anthropic Claude Opus 4.5</span>
            <span style="
              padding: 4px 10px;
              border-radius: 999px;
              background: linear-gradient(145deg, var(--surface-hi), var(--surface-lo));
              box-shadow: 2px 2px 4px var(--shadow-dark), -2px -2px 4px var(--shadow-light);
              font-size: 10px;
              font-weight: 600;
              color: var(--text-soft);
            ">OpenAI Codex</span>
            <span style="
              padding: 4px 10px;
              border-radius: 999px;
              background: linear-gradient(145deg, var(--surface-hi), var(--surface-lo));
              box-shadow: 2px 2px 4px var(--shadow-dark), -2px -2px 4px var(--shadow-light);
              font-size: 10px;
              font-weight: 600;
              color: var(--text-soft);
            ">Google Gemini Pro</span>
          </div>
          <div style="height: 1px; background: var(--border-soft); margin: 0 0 12px;"></div>
          <div style="font-size: 11px; color: var(--text-muted);">
            ¬© 2025 Sergio Pe√±a. All rights reserved.
          </div>
          <div style="height: 1px; background: var(--border-soft); margin: 12px 0;"></div>
          <div style="font-size: 13px; color: var(--text-soft); margin-bottom: 10px;">Try my other apps</div>
          <a
            href="https://www.sonotag.app"
            target="_blank"
            rel="noopener noreferrer"
            style="
              display: inline-flex;
              align-items: center;
              justify-content: center;
              gap: 8px;
              padding: 10px 20px;
              border-radius: 999px;
              background: linear-gradient(145deg, var(--surface-hi), var(--surface-lo));
              box-shadow: var(--shadow-raised);
              color: var(--text);
              font-size: 13px;
              font-weight: 600;
              text-decoration: none;
              transition: transform 120ms ease, box-shadow 120ms ease;
            "
          >üéß SonoTag</a>
        </div>
      </div>
    </div>
  </body>
</html>
